<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Jason Hilton" />

<meta name="date" content="2017-11-22" />

<title>Using ggfan with stan</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">Using ggfan with stan</h1>
<h4 class="author"><em>Jason Hilton</em></h4>
<h4 class="date"><em>2017-11-22</em></h4>



<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(rstan)</code></pre></div>
<pre><code>## Loading required package: StanHeaders</code></pre>
<pre><code>## rstan (Version 2.16.2, packaged: 2017-07-03 09:24:58 UTC, GitRev: 2e1f913d3ca3)</code></pre>
<pre><code>## For execution on a local, multicore CPU with excess RAM we recommend calling
## rstan_options(auto_write = TRUE)
## options(mc.cores = parallel::detectCores())</code></pre>
<pre><code>## 
## Attaching package: 'rstan'</code></pre>
<pre><code>## The following object is masked from 'package:tidyr':
## 
##     extract</code></pre>
<pre><code>## The following object is masked from 'package:magrittr':
## 
##     extract</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(dplyr)
<span class="kw">library</span>(magrittr)
<span class="kw">library</span>(tidyr)
<span class="kw">library</span>(tibble)

<span class="kw">library</span>(ggfan)</code></pre></div>
<p>The <code>ggfan</code> package can be used to plot output from common mcmc sampling programs. As an example we will fit a latent gaussian process model to some simulated count data using stan. First, we simulate some data and plot it. We simulate two observations at each x value, with the count outcome values depending on a sinusoidal latent rate variable.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">seed &lt;-<span class="st"> </span><span class="dv">34526</span>
<span class="kw">set.seed</span>(seed)

<span class="co"># data </span>
x &lt;-<span class="st"> </span><span class="kw">seq</span>(-<span class="dv">5</span>,<span class="dv">5</span>,<span class="fl">0.1</span>)
N &lt;-<span class="st"> </span><span class="kw">length</span>(x)
y &lt;-<span class="st"> </span><span class="kw">cbind</span>(<span class="kw">rpois</span>(N, <span class="kw">exp</span>(<span class="kw">sin</span>(x)+<span class="dv">2</span>)),<span class="kw">rpois</span>(N, <span class="kw">exp</span>(<span class="kw">sin</span>(x)+<span class="dv">2</span>)))

stan_data &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">N=</span>N, <span class="dt">x=</span>x, <span class="dt">y=</span>y)

<span class="kw">plot</span>(x,y[,<span class="dv">1</span>])
<span class="kw">points</span>(x,y[,<span class="dv">2</span>])</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The stan model used is a modified version of the Gaussian Process (GP) examples bundled with <code>rstan</code>, and is also based on the latent-variable discussion in the Bayesian Data Anaylsis edition 3 (Gelman et al. 2015). GPs are semi-parametric models based on the assumption that outcomes are joint multivariate normal, and that observations that are close to each other in terms of their covariate values are correlated in outputs.</p>
<p>The model is given below. The details are not especially important for this purpose, but for those familiar with GPs, the roughness and variance parameters are estimated as part of themodel, but a small fixed nugget is added to the diagonal to avoid numerical problems. The model can be compiled by saving the code below in a text file and reading in using <code>stan_model(file=&quot;path/to/model.stan&quot;)</code>.</p>
<pre class="stan"><code>data {
  int&lt;lower=1&gt; N;
  vector[N] x;
  int&lt;lower=0&gt; y[N,2];
}
transformed data {
  vector[N] mu;
  for (i in 1:N)
    mu[i] = 0;
}
parameters {
  real&lt;lower=0&gt; eta_sq;
  real&lt;lower=0&gt; rho_sq;
  vector[N] z;
}
model {
  matrix[N,N] Sigma;

  // off-diagonal elements
  for (i in 1:(N-1)) {
    for (j in (i+1):N) {
    Sigma[i,j] = eta_sq * exp(-rho_sq * pow(x[i] - x[j],2));
      Sigma[j,i] = Sigma[i,j]; // for symmetry
    }
  }

  // diagonal elements
  for (k in 1:N){
    Sigma[k,k] = eta_sq + 0.001; // nugget for numeric purposes
  }

  eta_sq ~ cauchy(0,5);
  rho_sq ~ cauchy(0,5);

  z ~ multi_normal(mu, Sigma);
  for (j in 1:2){
    y[,j] ~ poisson_log(z);
  }
}
generated quantities {
  int y_gen[N];
  for (i in 1:N){
    // only sample one observation per x
    y_gen[i] = poisson_rng(exp(z[i]));
  }
}
</code></pre>
<p>We can fit the model using the <code>sampling</code> command. This make take some time. The process can be speeded up by running chains in parallel by specifying the number of cores you wish to use via the <code>cores</code> argument to <code>sampling</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">gp_model_fit &lt;-<span class="st"> </span><span class="kw">sampling</span>(compiled_model, <span class="dt">data=</span>stan_data, <span class="dt">iter=</span><span class="dv">3000</span>,<span class="dt">thin=</span><span class="dv">6</span>)</code></pre></div>
<p>We can get an idea as to whether the samples have converged by examining the <span class="math inline">\(\hat{r}\)</span> (link)[<a href="http://www.stat.columbia.edu/~gelman/research/published/itsim.pdf" class="uri">http://www.stat.columbia.edu/~gelman/research/published/itsim.pdf</a>] diagnostic values. Values close to 1 indicate good convergence.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">stan_rhat</span>(gp_model_fit)</code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>We now want to convert the stan output to values that can be easily plotted using <code>ggfan</code>. We start with the latent variable <span class="math inline">\(z\)</span>. We first extract <code>z</code> from the fitted stan model with the <code>as.matrix</code> method of the <code>stan_fit</code> object, before adding the <code>x</code> covariate values with <code>mutate</code>.</p>
<p>Next, we convert to tidy data format using the <code>tidyr</code> function <code>gather</code>. And now we are ready to plot with <code>ggfan</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">z_df &lt;-<span class="st"> </span><span class="kw">as_tibble</span>(<span class="kw">t</span>(<span class="kw">as.matrix</span>(gp_model_fit, <span class="st">&quot;z&quot;</span>)))
z_df &lt;-<span class="st"> </span>z_df %&gt;%<span class="st"> </span><span class="kw">mutate</span>(<span class="dt">x=</span>x)

z_df_long &lt;-<span class="st"> </span>z_df %&gt;%<span class="st"> </span><span class="kw">gather</span>(<span class="dt">key=</span>Sim, <span class="dt">value=</span>z, -x)

<span class="kw">ggplot</span>(z_df_long, <span class="kw">aes</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>z)) +<span class="st"> </span><span class="kw">geom_fan</span>() +<span class="st"> </span><span class="kw">geom_line</span>(<span class="dt">data=</span><span class="kw">data.frame</span>(<span class="dt">x=</span>x,<span class="dt">y=</span><span class="kw">sin</span>(x)+<span class="dv">2</span>), <span class="kw">aes</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y),<span class="dt">colour=</span><span class="st">&quot;red&quot;</span>) +<span class="st"> </span><span class="kw">theme_minimal</span>() +<span class="st"> </span>
<span class="st">  </span><span class="kw">scale_fill_distiller</span>()</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>We can also follow the same process in order to examine the predictive distribution of the counts themselves. These are integers so naturally appear more discrete.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">y_df &lt;-<span class="st"> </span><span class="kw">as_tibble</span>(<span class="kw">t</span>(<span class="kw">as.matrix</span>(gp_model_fit, <span class="st">&quot;y_gen&quot;</span>)))
y_df &lt;-<span class="st"> </span>y_df %&gt;%<span class="st"> </span><span class="kw">mutate</span>(<span class="dt">x=</span>x)

y_df_long &lt;-<span class="st"> </span>y_df %&gt;%<span class="st"> </span><span class="kw">gather</span>(<span class="dt">key=</span>Sim, <span class="dt">value=</span>y, -x)

obs_data &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">x=</span><span class="kw">rep</span>(x,<span class="dv">2</span>), <span class="dt">y=</span><span class="kw">c</span>(y[,<span class="dv">1</span>], y[,<span class="dv">2</span>]))
<span class="kw">ggplot</span>(y_df_long, <span class="kw">aes</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y)) +<span class="st"> </span><span class="kw">geom_fan</span>() +<span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data=</span>obs_data, <span class="kw">aes</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y)) +<span class="st"> </span><span class="kw">theme_minimal</span>() +<span class="st"> </span>
<span class="st">  </span><span class="kw">scale_fill_distiller</span>() +<span class="st"> </span><span class="kw">geom_interval</span>()</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>A similar process can be folowed when using other MCMC sampling packages, such as <code>bugs</code> or <code>jags</code>.</p>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
