<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Jason Hilton" />

<meta name="date" content="2017-11-14" />

<title>Using ggfan with stan</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">Using ggfan with stan</h1>
<h4 class="author"><em>Jason Hilton</em></h4>
<h4 class="date"><em>2017-11-14</em></h4>



<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(rstan)</code></pre></div>
<pre><code>## Loading required package: StanHeaders</code></pre>
<pre><code>## rstan (Version 2.16.2, packaged: 2017-07-03 09:24:58 UTC, GitRev: 2e1f913d3ca3)</code></pre>
<pre><code>## For execution on a local, multicore CPU with excess RAM we recommend calling
## rstan_options(auto_write = TRUE)
## options(mc.cores = parallel::detectCores())</code></pre>
<pre><code>## 
## Attaching package: 'rstan'</code></pre>
<pre><code>## The following object is masked from 'package:tidyr':
## 
##     extract</code></pre>
<pre><code>## The following object is masked from 'package:magrittr':
## 
##     extract</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(dplyr)
<span class="kw">library</span>(magrittr)
<span class="kw">library</span>(tidyr)
<span class="kw">library</span>(tibble)

<span class="kw">library</span>(ggfan)</code></pre></div>
<p>The <code>ggfan</code> package can be used to plot output from common mcmc sampling programs. As an example we will fit a latent gaussian process model to some simulated count data using stan. First, we simulate some data and plot it. We simulate two observations at each x value, with the count outcome values depending on a sinusoidal latent rate variable.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">seed &lt;-<span class="st"> </span><span class="dv">34526</span>
<span class="kw">set.seed</span>(seed)

<span class="co"># data </span>
x &lt;-<span class="st"> </span><span class="kw">seq</span>(-<span class="dv">5</span>,<span class="dv">5</span>,<span class="fl">0.1</span>)
N &lt;-<span class="st"> </span><span class="kw">length</span>(x)
y &lt;-<span class="st"> </span><span class="kw">cbind</span>(<span class="kw">rpois</span>(N, <span class="kw">exp</span>(<span class="kw">sin</span>(x)+<span class="dv">2</span>)),<span class="kw">rpois</span>(N, <span class="kw">exp</span>(<span class="kw">sin</span>(x)+<span class="dv">2</span>)))

stan_data &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">N=</span>N, <span class="dt">x=</span>x, <span class="dt">y=</span>y)

<span class="kw">plot</span>(x,y[,<span class="dv">1</span>])
<span class="kw">points</span>(x,y[,<span class="dv">2</span>])</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The stan model used is a modified version of the Gaussian Process (GP) examples bundled with <code>rstan</code>, and is also based on the latent-variable discussion in the Bayesian Data Anaylsis edition 3 (Gelman et al. 2015). GPs are semi-parametric models based on the assumption that outcomes are joint multivariate normal, and that observations that are close to each other in terms of their covariate values are correlated in outputs.</p>
<p>The model is given below. The details are not especially important for this purpose, but for those familiar with GPs, the roughness and variance parameters are estimated as part of themodel, but a small fixed nugget is added to the diagonal to avoid numerical problems. The model can be compiled by saving the code below in a text file and reading in using <code>stan_model(file=&quot;path/to/model.stan&quot;)</code>.</p>
<pre class="stan"><code>data {
  int&lt;lower=1&gt; N;
  vector[N] x;
  int&lt;lower=0&gt; y[N,2];
}
transformed data {
  vector[N] mu;
  for (i in 1:N)
    mu[i] = 0;
}
parameters {
  real&lt;lower=0&gt; eta_sq;
  real&lt;lower=0&gt; rho_sq;
  vector[N] z;
}
model {
  matrix[N,N] Sigma;

  // off-diagonal elements
  for (i in 1:(N-1)) {
    for (j in (i+1):N) {
    Sigma[i,j] = eta_sq * exp(-rho_sq * pow(x[i] - x[j],2));
      Sigma[j,i] = Sigma[i,j]; // for symmetry
    }
  }

  // diagonal elements
  for (k in 1:N){
    Sigma[k,k] = eta_sq + 0.001; // nugget for numeric purposes
  }

  eta_sq ~ cauchy(0,5);
  rho_sq ~ cauchy(0,5);

  z ~ multi_normal(mu, Sigma);
  for (j in 1:2){
    y[,j] ~ poisson_log(z);
  }
}
generated quantities {
  int y_gen[N];
  for (i in 1:N){
    // only sample one observation per x
    y_gen[i] = poisson_rng(exp(z[i]));
  }
}
</code></pre>
<p>We can fit the model using the <code>sampling</code> command. This make take some time. The process can be speeded up by running chains in parallel by specifying the number of cores you wish to use via the <code>cores</code> argument to <code>sampling</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">gp_model_fit &lt;-<span class="st"> </span><span class="kw">sampling</span>(compiled_model, <span class="dt">data=</span>stan_data, <span class="dt">iter=</span><span class="dv">3000</span>,<span class="dt">thin=</span><span class="dv">6</span>)</code></pre></div>
<p>We can get an idea as to whether the samples have converged by examining the <span class="math inline">\(\hat{r}\)</span> (link)[<a href="http://www.stat.columbia.edu/~gelman/research/published/itsim.pdf" class="uri">http://www.stat.columbia.edu/~gelman/research/published/itsim.pdf</a>] diagnostic values. Values close to 1 indicate good convergence.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">stan_rhat</span>(gp_model_fit)</code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>We now want to convert the stan output to values that can be easily plotted using <code>ggfan</code>. We start with the latent variable <span class="math inline">\(z\)</span>. We first extract <code>z</code> from the fitted stan model with the <code>as.matrix</code> method of the <code>stan_fit</code> object, before adding the <code>x</code> covariate values with <code>mutate</code>.</p>
<p>Next, we convert to tidy data format using the <code>tidyr</code> function <code>gather</code>. And now we are ready to plot with <code>ggfan</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">z_df &lt;-<span class="st"> </span><span class="kw">as_tibble</span>(<span class="kw">t</span>(<span class="kw">as.matrix</span>(gp_model_fit, <span class="st">&quot;z&quot;</span>)))
z_df &lt;-<span class="st"> </span>z_df %&gt;%<span class="st"> </span><span class="kw">mutate</span>(<span class="dt">x=</span>x)

z_df_long &lt;-<span class="st"> </span>z_df %&gt;%<span class="st"> </span><span class="kw">gather</span>(<span class="dt">key=</span>Sim, <span class="dt">value=</span>z, -x)

<span class="kw">ggplot</span>(z_df_long, <span class="kw">aes</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>z)) +<span class="st"> </span><span class="kw">geom_fan</span>() +<span class="st"> </span><span class="kw">geom_line</span>(<span class="dt">data=</span><span class="kw">data.frame</span>(<span class="dt">x=</span>x,<span class="dt">y=</span><span class="kw">sin</span>(x)+<span class="dv">2</span>), <span class="kw">aes</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y),<span class="dt">colour=</span><span class="st">&quot;red&quot;</span>) +<span class="st"> </span><span class="kw">theme_minimal</span>() +<span class="st"> </span>
<span class="st">  </span><span class="kw">scale_fill_distiller</span>()</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>We can also follow the same process in order to examine the predictive distribution of the counts themselves. These are integers so naturally appear more discrete.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">y_df &lt;-<span class="st"> </span><span class="kw">as_tibble</span>(<span class="kw">t</span>(<span class="kw">as.matrix</span>(gp_model_fit, <span class="st">&quot;y_gen&quot;</span>)))
y_df &lt;-<span class="st"> </span>y_df %&gt;%<span class="st"> </span><span class="kw">mutate</span>(<span class="dt">x=</span>x)

y_df_long &lt;-<span class="st"> </span>y_df %&gt;%<span class="st"> </span><span class="kw">gather</span>(<span class="dt">key=</span>Sim, <span class="dt">value=</span>y, -x)

obs_data &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">x=</span><span class="kw">rep</span>(x,<span class="dv">2</span>), <span class="dt">y=</span><span class="kw">c</span>(y[,<span class="dv">1</span>], y[,<span class="dv">2</span>]))
<span class="kw">ggplot</span>(y_df_long, <span class="kw">aes</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y)) +<span class="st"> </span><span class="kw">geom_fan</span>() +<span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data=</span>obs_data, <span class="kw">aes</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y)) +<span class="st"> </span><span class="kw">theme_minimal</span>() +<span class="st"> </span>
<span class="st">  </span><span class="kw">scale_fill_distiller</span>() +<span class="st"> </span><span class="kw">geom_interval</span>()</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>A similar process can be folowed when using other MCMC sampling packages, such as <code>bugs</code> or <code>jags</code>.</p>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
